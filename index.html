<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="output.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/lib/browser.min.js"></script>
    <title>Document</title>

    <!-- copied print / page CSS from index.html -->
    <style>
      @page {
        /* size: A4; */
        margin: 0;
      }

      body {
        margin: 0;
        /* padding-top:  30px; */
        box-sizing: border-box;
        font-family: sans-serif;
      }

      .page {
        width: 100mm;
        height: 50mm;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: flex-start;
      }

      .row {
        display: flex;
        flex-direction: row;
        height: 50mm;
        /* margin-bottom: 0.5in; */
      }

      .cell {
        width: 50mm;
        height: 50mm;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .cell img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      th {
        position: relative;
      }

      .sort-icon {
        font-size: 1rem;
        margin-left: 4px;
        font-weight: bold;
      }

      /* .gap {
        width: 0.3in;
        height: 2in;
      } */

      #uploader {
        margin: 20px;
      }
      @media print {
        .onprint {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="onprint flex w-screen min-h-screen h-max p-6 bg-gray-100">
      <div class="flex flex-col gap-6">
        <!-- QR Generation -->
        <div class="flex justify-between items-start gap-6">
          <!-- Single QR Generation -->
          <div class="flex gap-4 bg-gray-50 px-4 py-2">
            <div class="flex flex-col gap-2">
              <div class="flex justify-between gap-4">
                <label for="qr-code"> QR Code </label>
                <input
                  type="text"
                  id="qr-code"
                  placeholder="Enter a QR Code"
                  value=""
                  class="bg-gray-200 rounded px-2 py-1 uppercase"
                />
              </div>
              <div class="flex gap-4">
                <label for="custom-text"> Custom Text </label>
                <input
                  type="text"
                  id="custom-text"
                  value=""
                  placeholder="Enter custom text"
                  class="bg-gray-200 rounded px-2 py-1"
                />
              </div>
              <button
                id="generate-qr"
                class="bg-sky-200 self-end w-max rounded px-2 py-1 disabled:cursor-not-allowed"
              >
                Generate QR
              </button>
              <span
                id="qr-validation-message"
                class="text-red-500 text-center"
              ></span>
            </div>

            <!-- Single QR Instructions -->
            <div class="text-red-400">
              <span>Instructions</span>
              <ul class="list-disc list-inside">
                <li>Enter a QR code</li>
                <li>Enter custom text (optional)</li>
                <li>Click "Generate QR" to generate QR</li>
                <li>Click "Print" to print QR</li>
              </ul>
            </div>
          </div>

          <!-- Bulk QR Generation -->
          <div class="flex gap-4 bg-gray-50 px-4 py-2">
            <div class="flex flex-col gap-2">
              <input
                type="file"
                id="qr-code-file"
                accept=".xlsx, .xls, .csv"
                class="px-2 py-1"
              />
              <div class="flex items-center gap-2">
                <input
                  type="radio"
                  id="with-custom-text"
                  value="with-custom-text"
                  name="qr-type"
                  checked
                />
                <label for="with-custom-text">With Custom Text</label>
              </div>
              <div class="flex items-center gap-2">
                <input
                  type="radio"
                  id="without-custom-text"
                  value="without-custom-text"
                  name="qr-type"
                />
                <label for="without-custom-text">Without Custom Text</label>
              </div>
              <button
                id="bulk-generate-button"
                class="bg-sky-200 rounded px-2 py-1 disabled:cursor-not-allowed disabled:bg-opacity-50"
              >
                Generate Bulk QR
              </button>
            </div>

            <!-- Bulk QR Instructions -->
            <div class="text-red-400">
              <span>Instructions</span>
              <ul class="list-disc list-inside">
                <li>Select a file containing QR codes</li>
                <li>Select QR type (with or without custom text)</li>
                <li>The order of QR codes will be same as in the file</li>
                <li>
                  Example file format:
                  <a
                    href="./assets/qr_test.xlsx"
                    target="_blank"
                    class="text-blue-400 underline"
                    >qr_test.xlsx</a
                  >
                </li>
                <li>Click "Generate Bulk QR" to generate QRs</li>
                <li>Click "Print Bulk QR" to print QRs</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- QR Code Previews -->
        <div class="flex flex-col gap-3">
          <button
            id="reset-button"
            class="bg-red-400 w-max px-2 py-1 rounded disabled:cursor-not-allowed"
          >
            Reset All
          </button>
          <div>
            <p>Tools & Tutorials for printer setup</p>
            <button
              onclick="document.getElementById('setup-modal').classList.remove('hidden')"
              class="bg-sky-200 px-2 py-1 rounded disabled:cursor-not-allowed disabled:bg-opacity-50"
            >
              Open Setup Guide
            </button>
          </div>

          <button
            class="bg-sky-200 w-max px-2 py-1 rounded disabled:cursor-not-allowed disabled:bg-opacity-50"
            id="test-printer-button"
          >
            Test Printer
          </button>

          <button
            id="open-print-button"
            onclick="document.getElementById('qr-detail-modal').classList.remove('hidden')"
            disabled
            class="bg-sky-200 w-max px-2 py-1 rounded disabled:hidden"
          >
            A4 Print
          </button>

          <h2>QR Codes</h2>
          <div>
            <label for="page-size">Page Size</label>
            <select id="page-size" class="bg-gray-200 rounded px-2 py-1">
              <option value="LARGE">100mm x 50mm</option>
              <option value="MEDIUM">100mm x 25mm</option>
              <option value="SMALL">25mm x 25mm</option>
            </select>
          </div>
          <div class="flex items-center gap-4">
            <label for="qr-width">Width (mm)</label>
            <!-- <input
              id="qr-width"
              type="number"
              step="0.1"
              value="50"
              class="bg-gray-200 rounded px-2 py-1 w-20"
            /> -->
            <select id="qr-width" class="bg-gray-200 rounded px-2 py-1">
              <option value="100" selected>100mm</option>
              <option value="50">50mm</option>
              <option value="25">25mm</option>
            </select>
            <label for="qr-height">Height (mm)</label>
            <!-- <input
              id="qr-height"
              type="number"
              step="0.1"
              value="50"
              class="bg-gray-200 rounded px-2 py-1 w-20"
            /> -->
            <select id="qr-height" class="bg-gray-200 rounded px-2 py-1">
              <option value="50" selected>50mm</option>
              <option value="25">25mm</option>
            </select>
            <label for="per-row">Per row</label>
            <input
              id="per-row"
              type="number"
              min="1"
              value="2"
              class="bg-gray-200 rounded px-2 py-1 w-16"
            />
            <label for="quantity">Number of QR codes to print: </label>
            <input
              type="number"
              id="quantity"
              value="2"
              class="bg-gray-200 rounded w-20 px-2 py-1 disabled:cursor-not-allowed"
            />
            <button
              id="print-button"
              disabled
              class="bg-sky-200 rounded px-2 py-1 disabled:cursor-not-allowed disabled:bg-opacity-50"
            >
              Print
            </button>
          </div>

          <div id="qr-codes">
            <img
              id="qr-preview"
              class="w-[50mm] h-[50mm] border border-gray-300"
              alt="QR Code Preview"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Printer Setup Modal -->
    <div
      id="setup-modal"
      class="hidden fixed inset-0 bg-black/50 flex items-center justify-center"
    >
      <div
        class="bg-white rounded-lg p-6 w-[800px] max-h-[80vh] overflow-y-auto"
      >
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold">Printer Setup Guide</h2>
          <button
            onclick="document.getElementById('setup-modal').classList.add('hidden')"
            class="text-gray-500 hover:text-gray-700"
          >
            âœ•
          </button>
        </div>

        <div class="space-y-6">
          <!-- Tools Section -->
          <div>
            <h3 class="text-lg font-semibold mb-2">Download Tools</h3>
            <ul class="space-y-2">
              <li>
                <a
                  href="./assets/TSC.zip"
                  class="flex items-center gap-2 text-blue-600 hover:underline"
                  download
                >
                  <svg
                    class="w-5 h-5"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                    />
                  </svg>
                  TSC Setup Utilities
                </a>
              </li>
              <li>
                <a
                  href="./assets//TSC.zip"
                  class="flex items-center gap-2 text-blue-600 hover:underline"
                  download
                >
                  <svg
                    class="w-5 h-5"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                    />
                  </svg>
                  Printer Drivers Package
                </a>
              </li>
            </ul>
          </div>

          <!-- Video Tutorials Section -->
          <div>
            <h3 class="text-lg font-semibold mb-2">Video Tutorials</h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="space-y-2">
                <div class="aspect-video bg-gray-100">
                  <iframe
                    width="100%"
                    height="100%"
                    src="https://www.youtube.com/embed/your-video-id"
                    frameborder="0"
                    allowfullscreen
                  >
                  </iframe>

                  <!-- <video
                    width="100%"
                    height="100%"
                    controls
                    src="https://www.example.com/your-video-file.mp4"
                  ></video> -->
                </div>
                <p class="font-medium">Initial Printer Setup</p>
              </div>
              <div class="space-y-2">
                <div class="aspect-video bg-gray-100">
                  <iframe
                    width="100%"
                    height="100%"
                    src="https://www.youtube.com/embed/your-video-id"
                    frameborder="0"
                    allowfullscreen
                  ></iframe>
                </div>
                <p class="font-medium">Troubleshooting Guide</p>
              </div>
            </div>
          </div>

          <!-- Setup Instructions -->
          <div>
            <h3 class="text-lg font-semibold mb-2">Quick Setup Steps</h3>
            <ol class="list-decimal list-inside space-y-2">
              <li>Download and install TSC Setup Utilities</li>
              <li>Install printer drivers from the package</li>
              <li>Connect your printer via USB or network</li>
              <li>Run TSC Setup Utilities and add your printer</li>
              <li>Set paper size to match your labels</li>
              <li>Print a test page to verify setup</li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <!-- Print QR Details Modal -->
    <div
      id="qr-detail-modal"
      class="fixed inset-0 hidden flex items-center justify-center bg-black/50 z-50"
    >
      <div class="bg-white p-6 rounded shadow-xl w-[90%] max-w-5xl">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold">QR Details</h2>
          <button
            onclick="document.getElementById('qr-detail-modal').classList.add('hidden')"
            class="text-gray-500 hover:text-gray-700"
          >
            âœ•
          </button>
        </div>

        <!-- Dynamic column selector -->
        <div class="mb-4 flex items-center gap-4">
          <label for="column-select" class="font-medium">Add Columns:</label>
          <select
            id="column-select"
            class="border rounded min-w-32 px-2 py-1"
            multiple
          ></select>
          <button
            id="apply-columns"
            class="bg-blue-500 text-white px-3 py-1 rounded"
          >
            Apply
          </button>
          <button
            id="download-table"
            class="bg-green-600 text-white px-3 py-1 rounded ml-auto"
          >
            Download CSV
          </button>
        </div>

        <!-- Table container -->
        <div class="overflow-x-auto max-h-[60vh]">
          <table
            id="qr-detail-table"
            class="min-w-full border border-gray-300 text-sm"
          >
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr id="table-head-row"></tr>
            </thead>
            <tbody id="table-body"></tbody>
          </table>
        </div>

        <div class="flex justify-end gap-4 pt-4 mt-4 border-t">
          <button
            id="close-qr-detail-modal"
            onclick="document.getElementById('qr-detail-modal').classList.add('hidden')"
            class="bg-gray-500 text-white px-4 py-2 rounded"
          >
            Close
          </button>
          <button
            id="print-qr-detail"
            disabled
            class="bg-sky-500 text-white px-4 py-2 rounded disabled:opacity-50 disabled:cursor-not-allowed"
          >
            Print
          </button>
        </div>
      </div>
    </div>

    <!-- load app script after DOM -->
    <script type="module" src="main.js"></script>
  </body>
</html>
